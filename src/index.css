/* src/index.css */

/* =========================
 * iOS Safari / Mobile basics
 * ========================= */

/* iOS Safari: 入力欄が原因の自動ズームを防ぐ */
input,
textarea,
select {
  font-size: 16px;
}

/* iOSの謎の文字拡大を抑制 */
html {
  -webkit-text-size-adjust: 100%;
}

/* 基本リセット */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  width: 100%;
  margin: 0;
}

#root {
  height: 100%;
}

/* =========================
 * App root: background system
 * ========================= */

#app-root {
  position: relative;
  height: 100dvh;
  width: 100vw;
  overflow: hidden;

  color: rgba(255, 255, 255, 0.92);

  /* 変数の安全デフォルト（JSが壊れても最低限見える） */
  --bg-image: none;
  --bg-blur: 0px;
  --bg-dim: 0.25;

  --glass-blur: 10px;
  --glass-alpha: 0.22;
  --glass-alpha-strong: 0.35;

  -webkit-overflow-scrolling: touch;
}

/* ✅ 背景画像 + 暗幕 を“同じレイヤー”に統合（ここが本丸）
   - 暗幕を ::after で別レイヤーにすると、背後がベタ色になり
     backdrop-filter の「ぼかし」が見えなくなることがある
*/
#app-root::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;

  background:
    /* 1) 背景画像 */
    var(--bg-image),
    /* 2) 暗幕（Settingsのスライダーにリンク） */
    linear-gradient(rgba(0, 0, 0, var(--bg-dim)), rgba(0, 0, 0, var(--bg-dim)));

  background-size: cover, cover;
  background-position: center, center;
  background-repeat: no-repeat, no-repeat;

  /* 背景ぼかし（画像＋暗幕まとめてぼかす） */
  filter: blur(var(--bg-blur));
  transform: scale(1.03); /* ぼかし端の欠け対策 */
  will-change: filter, transform;
  pointer-events: none;
}

/* ✅ 暗幕専用の ::after は “作らない” */
/* #app-root::after { ... } は不要 */

/* =========================
 * Glass panel (frosted UI)
 * ========================= */

.glass-panel {
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  background: rgba(17, 17, 17, var(--glass-alpha));
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
}

.glass-panel.strong {
  background: rgba(17, 17, 17, var(--glass-alpha-strong));
}

/* =========================
 * FadeSwitch
 * ========================= */

.fade-switch {
  width: 100%;
  height: 100%;
  min-height: 0;

  opacity: 1;
  transform: translateY(0);
  transition:
    opacity var(--fade-ms, 220ms) ease,
    transform var(--fade-ms, 220ms) ease;
  will-change: opacity, transform;
}

.fade-switch[data-phase="exit"] {
  opacity: 0;
  transform: translateY(var(--fade-lift, 6px));
}

.fade-switch[data-phase="enter"] {
  opacity: 1;
  transform: translateY(0);
}

/* =========================
 * Optional: nicer defaults
 * ========================= */

button,
input,
select {
  font: inherit;
}

code {
  font-family:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;
  font-size: 0.95em;
}
