/* src/index.css */

/* =========================
 * iOS Safari / Mobile basics
 * ========================= */

/* iOS Safari: 入力欄が原因の自動ズームを防ぐ */
input,
textarea,
select {
  font-size: 16px;
}

/* iOSの謎の文字拡大を抑制 */
html {
  -webkit-text-size-adjust: 100%;
}

/* 基本リセット */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  width: 100%;
  margin: 0;
}

/* React root (Vite) */
#root {
  height: 100%;
}

/* =========================
 * App root: background system
 * =========================
 * App.tsx が #app-root に CSS変数を付与する前提:
 *  --bg-image: url("...") or none
 *  --bg-blur: "12px" 等
 *  --bg-dim : 0〜1
 *  --glass-blur: "10px" 等
 *  --glass-alpha: 0〜1
 *  --glass-alpha-strong: 0〜1
 *
 * 重要:
 * 背景は #app-root の ::before / ::after で描画し、
 * Stage/UI は z-index > 0 にする
 */

#app-root {
  position: relative;
  height: 100dvh;
  width: 100vw;
  overflow: hidden;
  color: rgba(255, 255, 255, 0.92);

  /* 変数の安全デフォルト（JSが壊れても最低限見える） */
  --bg-image: none;
  --bg-blur: 0px;
  --bg-dim: 0.25;

  --glass-blur: 10px;
  --glass-alpha: 0.22;
  --glass-alpha-strong: 0.35;

  /* iOSのスクロール/合成の変な挙動を抑える */
  -webkit-overflow-scrolling: touch;
}

/* 背景画像レイヤー */
#app-root::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;

  background-image: var(--bg-image);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  /* 背景ぼかし */
  filter: blur(var(--bg-blur));
  transform: scale(1.03); /* ぼかし端の欠け対策 */
  will-change: filter, transform;
  pointer-events: none;
}

/* 暗幕レイヤー（ここが “背景の暗幕” の本体） */
#app-root::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;

  background: rgba(0, 0, 0, var(--bg-dim));
  pointer-events: none;
}

/* =========================
 * Glass panel (frosted UI)
 * ========================= */

/* backdrop-filter は “背景が背後に存在” して初めて効く。
 * なので必ず z-index:1以上の要素に使うこと。
 */
.glass-panel {
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  background: rgba(17, 17, 17, var(--glass-alpha));
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
}

.glass-panel.strong {
  background: rgba(17, 17, 17, var(--glass-alpha-strong));
}

/* =========================
 * FadeSwitch
 * =========================
 * FadeSwitch.tsx は .fade-switch + data-phase を使う前提。
 * これが無いと「フェードが効かない」。
 */

.fade-switch {
  width: 100%;
  height: 100%;
  min-height: 0;

  opacity: 1;
  transform: translateY(0);
  transition:
    opacity var(--fade-ms, 220ms) ease,
    transform var(--fade-ms, 220ms) ease;
  will-change: opacity, transform;
}

/* exit: 消える */
.fade-switch[data-phase="exit"] {
  opacity: 0;
  transform: translateY(var(--fade-lift, 6px));
}

/* enter: 出る（idleに戻す前提なので、ここは一瞬だけ使われる） */
.fade-switch[data-phase="enter"] {
  opacity: 1;
  transform: translateY(0);
}

/* =========================
 * Optional: nicer defaults
 * ========================= */

button,
input,
select {
  font: inherit;
}

code {
  font-family:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;
  font-size: 0.95em;
}
